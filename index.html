<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Huerta Escolar - Mejoras</title>
  <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 20px;
    }
    h2 {
      color: #146214;
    }
    #alerta {
      font-weight: bold;
      font-size: 18px;
      margin-top: 15px;
    }
    table {
      border-collapse: collapse;
      width: 100%;
      margin-top: 20px;
    }
    th, td {
      border: 1px solid #ccc;
      padding: 8px;
      text-align: center;
    }
    th {
      background-color: #e8f5e9;
    }
  </style>
</head>
<body>
  <h2>🌱 Gráficas y Alertas en Tiempo Real</h2>

  <!-- Contenedor de la gráfica -->
  <div id="graficaHumedad" style="width: 100%; height: 400px;"></div>

  <!-- Alerta -->
  <div id="alerta"></div>

  <!-- Tabla de registros -->
  <h3>📋 Registros de Datos</h3>
  <table id="tablaRegistros">
    <thead>
      <tr>
        <th>Hora</th>
        <th>Humedad del Suelo</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <script>
    google.charts.load('current', {packages:['corechart']});
    google.charts.setOnLoadCallback(dibujarGrafica);

    let datos = [
      ['Hora', 'Humedad del Suelo'],
      ['18:04', 550],
      ['18:05', 380],
      ['18:06', 620],
      ['18:07', 450],
      ['18:08', 700]
    ];

    function dibujarGrafica() {
      let data = google.visualization.arrayToDataTable(datos);
      let options = {
        title: 'Humedad del Suelo',
        curveType: 'function',
        legend: { position: 'bottom' },
        colors: ['#2e7d32'],
        areaOpacity: 0.2
      };

      let chart = new google.visualization.AreaChart(document.getElementById('graficaHumedad'));
      chart.draw(data, options);

      // Verificar alerta
      let ultimaLectura = datos[datos.length - 1][1];
      let alerta = document.getElementById("alerta");
      if (ultimaLectura < 400) {
        alerta.innerHTML = "⚠️ ¡Alerta! La humedad del suelo está muy baja (" + ultimaLectura + ")";
        alerta.style.color = "red";
      } else {
        alerta.innerHTML = "✅ Humedad del suelo en nivel adecuado (" + ultimaLectura + ")";
        alerta.style.color = "green";
      }

      // Llenar tabla con los registros
      let tabla = document.querySelector("#tablaRegistros tbody");
      tabla.innerHTML = "";
      for (let i = 1; i < datos.length; i++) {
        let fila = "<tr><td>" + datos[i][0] + "</td><td>" + datos[i][1] + "</td></tr>";
        tabla.innerHTML += fila;
      }
    }
  </script>
</body>
</html>


  </script>
</body>
</html>

